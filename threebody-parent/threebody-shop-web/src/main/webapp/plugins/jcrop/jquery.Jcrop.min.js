var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(me){me.Jcrop=function(e,t){var n,b=me.extend({},me.Jcrop.defaults),o=!1;function v(e){return parseInt(e,10)+"px"}function m(e){return parseInt(e,10)+"%"}function S(e){return b.baseClass+"-"+e}function i(e){e=me(e).offset();return[e.left,e.top]}function r(e){return[e.pageX-W[0],e.pageY-W[1]]}function a(e){"object"!==(void 0===e?"undefined":_typeof(e))&&(e={}),"function"!=typeof(b=me.extend(b,e)).onChange&&(b.onChange=function(){}),"function"!=typeof b.onSelect&&(b.onSelect=function(){}),"function"!=typeof b.onRelease&&(b.onRelease=function(){})}function s(e,t){if(W=i(k),ce.setCursor("move"===e?e:e+"-resize"),"move"===e)return ce.activateHandlers((n=t,fe.watchKeys(),function(e){$.moveOffset([e[0]-n[0],e[1]-n[1]]),n=e,ie.update()}),d);var n,o,r,a=$.getFixed(),s=c(e),t=$.getCorner(c(s));$.setPressed($.getCorner(s)),$.setCurrent(t),ce.activateHandlers((o=e,r=a,function(e){if(b.aspectRatio)switch(o){case"e":case"w":e[1]=r.y+1;break;case"n":case"s":e[0]=r.x+1}else switch(o){case"e":case"w":e[1]=r.y2;break;case"n":case"s":e[0]=r.x2}$.setCurrent(e),ie.update()}),d)}function c(e){switch(e){case"n":return"sw";case"s":case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function C(t){return function(e){return b.disabled||"move"===t&&!b.allowMove||(j=!0,s(t,r(e)),e.stopPropagation(),e.preventDefault()),!1}}function u(e,t,n){var o=e.width(),r=e.height();t<o&&0<t&&(r=(o=t)/e.width()*e.height()),n<r&&0<n&&(o=(r=n)/e.height()*e.width()),Y=e.width()/o,X=e.height()/r,e.width(o).height(r)}function I(e){return{x:parseInt(e.x*Y,10),y:parseInt(e.y*X,10),x2:parseInt(e.x2*Y,10),y2:parseInt(e.y2*X,10),w:parseInt(e.w*Y,10),h:parseInt(e.h*X,10)}}function d(e){var t=$.getFixed();t.w>b.minSelect[0]&&t.h>b.minSelect[1]?(ie.enableHandles(),ie.done()):ie.release(),ce.setCursor(b.allowSelect?"crosshair":"default")}function l(e){if(b.disabled)return!1;if(!b.allowSelect)return!1;j=!0,W=i(k),ie.disableHandles(),(t="crosshair")!==n&&(ce.setCursor(t),n=t);var t=r(e);return $.setPressed(t),ie.update(),ce.activateHandlers(f,d),fe.watchKeys(),e.stopPropagation(),e.preventDefault(),!1}function f(e){$.setCurrent(e),ie.update()}function z(){var e=me("<div></div>").addClass(S("tracker"));return me.browser.msie&&e.css({opacity:0,backgroundColor:"white"}),e}me.browser.msie&&"6"===me.browser.version.split(".")[0]&&(o=!0),"object"!==(void 0===e?"undefined":_typeof(e))&&(e=me(e)[0]),"object"!==(void 0===t?"undefined":_typeof(t))&&(t={}),a(t);var t={border:"none",margin:0,padding:0,position:"absolute"},p=me(e),k=p.clone().removeAttr("id").css(t);k.width(p.width()),k.height(p.height()),p.after(k).hide(),u(k,b.boxWidth,b.boxHeight);var g=k.width(),O=k.height(),M=me("<div />").width(g).height(O).addClass(S("holder")).css({position:"relative",backgroundColor:b.bgColor}).insertAfter(p).append(k);delete b.bgColor,b.addClass&&M.addClass(b.addClass);var T=me("<img />").attr("src",k.attr("src")).css(t).width(g).height(O),H=me("<div />").width(m(100)).height(m(100)).css({zIndex:310,position:"absolute",overflow:"hidden"}).append(T),P=me("<div />").width(m(100)).height(m(100)).css("zIndex",320),F=me("<div />").css({position:"absolute",zIndex:300}).insertBefore(k).append(H,P);o&&F.css({overflowY:"hidden"});var D,E,R,J,Y,X,j,A,B=b.boundary,K=z().width(g+2*B).height(O+2*B).css({position:"absolute",top:v(-B),left:v(-B),zIndex:290}).mousedown(l),_=b.bgOpacity,W=i(k),V={createDragger:function(t){return function(e){return e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,b.disabled||"move"===t&&!b.allowMove||(j=!0,s(t,r(e)),e.stopPropagation(),e.preventDefault()),!1}},newSelection:function(e){return e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,l(e)},isSupported:q,support:!0===b.touchSupport||!1===b.touchSupport?b.touchSupport:q()};function q(){var e,t={},n=["touchstart","touchmove","touchend"],o=document.createElement("div");try{for(e=0;e<n.length;e++){var r=n[e],a=(r="on"+r)in o;a||(o.setAttribute(r,"return;"),a="function"==typeof o[r]),t[n[e]]=a}return t.touchstart&&t.touchend&&t.touchmove}catch(e){return!1}}var Q,G,L,N,U,Z,$=(Z=U=N=L=0,{flipCoords:ne,setPressed:function(e){e=te(e),U=L=e[0],Z=N=e[1]},setCurrent:function(e){e=te(e),Q=e[0]-U,G=e[1]-Z,U=e[0],Z=e[1]},getOffset:function(){return[Q,G]},moveOffset:function(e){var t=e[0],e=e[1];L+t<0&&(t-=t+L),N+e<0&&(e-=e+N),O<Z+e&&(e+=O-(Z+e)),g<U+t&&(t+=g-(U+t)),L+=t,U+=t,N+=e,Z+=e},getCorner:function(e){var t=ee();switch(e){case"ne":return[t.x2,t.y];case"nw":return[t.x,t.y];case"se":return[t.x2,t.y2];case"sw":return[t.x,t.y2]}},getFixed:ee});function ee(){if(!b.aspectRatio)return function(){var e,t=U-L,n=Z-N;D&&Math.abs(t)>D&&(U=0<t?L+D:L-D);E&&Math.abs(n)>E&&(Z=0<n?N+E:N-E);J/X&&Math.abs(n)<J/X&&(Z=0<n?N+J/X:N-J/X);R/Y&&Math.abs(t)<R/Y&&(U=0<t?L+R/Y:L-R/Y);L<0&&(U-=L,L-=L);N<0&&(Z-=N,N-=N);U<0&&(L-=U,U-=U);Z<0&&(N-=Z,Z-=Z);g<U&&(L-=e=U-g,U-=e);O<Z&&(N-=e=Z-O,Z-=e);g<L&&(Z-=e=L-O,N-=e);O<N&&(Z-=e=N-O,N-=e);return oe(ne(L,N,U,Z))}();var e,t,n=b.aspectRatio,o=b.minSize[0]/Y,r=b.maxSize[0]/Y,a=b.maxSize[1]/X,s=U-L,i=Z-N,c=Math.abs(s),u=Math.abs(i);return 0===r&&(r=10*g),0==a&&0,c/u<n?(t=Z,w=u*n,(e=s<0?L-w:w+L)<0?(e=0,h=Math.abs((e-L)/n),t=i<0?N-h:h+N):g<e&&(e=g,h=Math.abs((e-L)/n),t=i<0?N-h:h+N)):(e=U,h=c/n,(t=i<0?N-h:N+h)<0?(t=0,w=Math.abs((t-N)*n),e=s<0?L-w:w+L):O<t&&(t=O,w=Math.abs(t-N)*n,e=s<0?L-w:w+L)),L<e?(e-L<o?e=L+o:r<e-L&&(e=L+r),t=N<t?N+(e-L)/n:N-(e-L)/n):e<L&&(L-e<o?e=L-o:r<L-e&&(e=L-r),t=N<t?N+(L-e)/n:N-(L-e)/n),e<0?(L-=e,e=0):g<e&&(L-=e-g,e=g),t<0?(N-=t,t=0):O<t&&(N-=t-O,t=O),oe(ne(L,N,e,t))}function te(e){return e[0]<0&&(e[0]=0),e[1]<0&&(e[1]=0),e[0]>g&&(e[0]=g),e[1]>O&&(e[1]=O),[e[0],e[1]]}function ne(e,t,n,o){var r=e,a=n,s=t,i=o;return n<e&&(r=n,a=e),o<t&&(s=o,i=t),[Math.round(r),Math.round(s),Math.round(a),Math.round(i)]}function oe(e){return{x:e[0],y:e[1],x2:e[2],y2:e[3],w:e[2]-e[0],h:e[3]-e[1]}}var re,ae,se,ie=function(){var o,a=370,r={},s=!1,i=b.handleOffset;function e(e){e=me("<div />").css({position:"absolute",opacity:b.borderOpacity}).addClass(S(e));return H.append(e),e}function c(e,t){t=me("<div />").mousedown(C(e)).css({cursor:e+"-resize",position:"absolute",zIndex:t});return V.support&&t.bind("touchstart",V.createDragger(e)),P.append(t),t}function t(e){var t=b.handleSize,n=t,o=t,r=i,t=i;switch(e){case"n":case"s":o=m(100);break;case"e":case"w":n=m(100)}return c(e,a++).width(o).height(n).css({top:v(1-r),left:v(1-t)})}function n(e){for(var t=0;t<e.length;t++)r[e[t]]=c(e[t],a++).css({top:v(1-i),left:v(1-i),opacity:b.handleOpacity}).addClass(S("handle"))}function u(e){var t=Math.round(e.h/2-i),n=Math.round(e.w/2-i),o=e.w-i,e=e.h-i;r.e&&(r.e.css({top:v(t),left:v(o)}),r.w.css({top:v(t)}),r.s.css({top:v(e),left:v(n)}),r.n.css({left:v(n)})),r.ne&&(r.ne.css({left:v(o)}),r.se.css({top:v(e),left:v(o)}),r.sw.css({top:v(e)})),r.b&&(r.b.css({top:v(e)}),r.r.css({left:v(o)}))}function d(){var e=$.getFixed();$.setPressed([e.x,e.y]),$.setCurrent([e.x2,e.y2]),l()}function l(){if(o)return f()}function f(){var e,t,n=$.getFixed();e=n.w,t=n.h,F.width(e).height(t),e=n.x,t=n.y,T.css({top:v(-t),left:v(-e)}),F.css({top:v(t),left:v(e)}),s&&u(n),o||function(){F.show(),b.bgFade?k.fadeTo(b.fadeTime,_):k.css("opacity",_);o=!0}(),b.onChange.call(ye,I(n))}function p(){if(s=!0,b.allowResize)return u($.getFixed()),P.show(),!0}function h(){s=!1,P.hide()}function g(e){(A===e?h:p)()}b.drawBorders&&(e("hline"),e("hline bottom"),e("vline"),e("vline right")),b.dragEdges&&(r.t=t("n"),r.b=t("s"),r.r=t("e"),r.l=t("w")),b.sideHandles&&n(["n","s","e","w"]),b.cornerHandles&&n(["sw","nw","ne","se"]);var w=z().mousedown(C("move")).css({cursor:"move",position:"absolute",zIndex:360});return V.support&&w.bind("touchstart.jcrop",V.createDragger("move")),H.append(w),h(),{updateVisible:l,update:f,release:function(){h(),F.hide(),b.bgFade?k.fadeTo(b.fadeTime,1):k.css("opacity",1),o=!1,b.onRelease.call(ye)},refresh:d,isAwake:function(){return o},setCursor:function(e){w.css("cursor",e)},enableHandles:p,enableOnly:function(){s=!0},showHandles:function(){s&&(u($.getFixed()),P.show())},disableHandles:h,animMode:g,done:function(){g(!1),d()}}}(),ce=(re=function(){},ae=function(){},se=b.trackDocument,V.support&&me(document).bind("touchmove",function(e){return e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,ue(e)}).bind("touchend",function(e){return e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,de(e)}),se||K.mousemove(ue).mouseup(de).mouseout(de),k.before(K),{activateHandlers:function(e,t){return j=!0,re=e,ae=t,K.css({zIndex:450}),se&&me(document).bind("mousemove",ue).bind("mouseup",de),!1},setCursor:function(e){K.css("cursor",e)}});function ue(e){return re(r(e)),!1}function de(e){return e.preventDefault(),e.stopPropagation(),j&&(j=!1,ae(r(e)),ie.isAwake()&&b.onSelect.call(ye,I($.getFixed())),K.css({zIndex:290}),se&&me(document).unbind("mousemove",ue).unbind("mouseup",de),re=function(){},ae=function(){}),!1}var le,fe=(le=me('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}),t=me("<div />").css({position:"absolute",overflow:"hidden"}).append(le),b.keySupport&&(le.keydown(function(e){if(e.ctrlKey)return!0;var t=!!e.shiftKey?10:1;switch(e.keyCode){case 37:pe(e,-t,0);break;case 39:pe(e,t,0);break;case 38:pe(e,0,-t);break;case 40:pe(e,0,t);break;case 27:ie.release();break;case 9:return!0}return!1}).blur(function(e){le.hide()}),o||!b.fixedSupport?(le.css({position:"absolute",left:"-20px"}),t.append(le).insertBefore(k)):le.insertBefore(k)),{watchKeys:function(){b.keySupport&&(le.show(),le.focus())}});function pe(e,t,n){b.allowMove&&($.moveOffset([t,n]),ie.updateVisible()),e.preventDefault(),e.stopPropagation()}function he(e){ge([parseInt(e[0],10)/Y,parseInt(e[1],10)/X,parseInt(e[2],10)/Y,parseInt(e[3],10)/X])}function ge(e){$.setPressed([e[0],e[1]]),$.setCurrent([e[2],e[3]]),ie.update()}function we(){b.disabled=!0,ie.disableHandles(),ie.setCursor("default"),ce.setCursor("default")}function be(){b.disabled=!1,ve()}function ve(e){b.allowResize?e?ie.enableOnly():ie.enableHandles():ie.disableHandles(),ce.setCursor(b.allowSelect?"crosshair":"default"),ie.setCursor(b.allowMove?"move":"default"),b.hasOwnProperty("setSelect")&&(he(b.setSelect),ie.done(),delete b.setSelect),b.hasOwnProperty("trueSize")&&(Y=b.trueSize[0]/g,X=b.trueSize[1]/O),b.hasOwnProperty("bgColor")&&(me.fx.step.hasOwnProperty("backgroundColor")&&b.fadeTime?M.animate({backgroundColor:b.bgColor},{queue:!1,duration:b.fadeTime}):M.css("backgroundColor",b.bgColor),delete b.bgColor),b.hasOwnProperty("bgOpacity")&&(_=b.bgOpacity,ie.isAwake()&&(b.fadeTime?k.fadeTo(b.fadeTime,_):M.css("opacity",b.opacity)),delete b.bgOpacity),D=b.maxSize[0]||0,E=b.maxSize[1]||0,R=b.minSize[0]||0,J=b.minSize[1]||0,b.hasOwnProperty("outerImage")&&(k.attr("src",b.outerImage),delete b.outerImage),ie.refresh()}V.support&&K.bind("touchstart",V.newSelection),P.hide(),ve(!0);var ye={setImage:function(r,a){ie.release(),we();var s=new Image;s.onload=function(){var e=s.width,t=s.height,n=b.boxWidth,o=b.boxHeight;k.width(e).height(t),k.attr("src",r),T.attr("src",r),u(k,n,o),g=k.width(),O=k.height(),T.width(g).height(O),K.width(g+2*B).height(O+2*B),M.width(g).height(O),be(),"function"==typeof a&&a.call(ye)},s.src=r},animateTo:function(e,t){var n,o,r,a,s,i,c,u,d,l=parseInt(e[0],10)/Y,f=parseInt(e[1],10)/X,p=parseInt(e[2],10)/Y,h=parseInt(e[3],10)/X;function g(){window.setTimeout(d,o)}A||(l=$.flipCoords(l,f,p,h),f=[(f=$.getFixed()).x,f.y,f.x2,f.y2],n=f,o=b.animationDelay,r=l[0]-f[0],a=l[1]-f[1],s=l[2]-f[2],i=l[3]-f[3],c=0,u=b.swingSpeed,x=n[0],y=n[1],p=n[2],h=n[3],ie.animMode(!0),d=function(){c+=(100-c)/u,n[0]=x+c/100*r,n[1]=y+c/100*a,n[2]=p+c/100*s,n[3]=h+c/100*i,99.8<=c&&(c=100),c<100?(ge(n),g()):(ie.done(),"function"==typeof t&&t.call(ye))},g())},setSelect:he,setOptions:function(e){a(e),ve()},tellSelect:function(){return I($.getFixed())},tellScaled:function(){return $.getFixed()},setClass:function(e){M.removeClass().addClass(S("holder")).addClass(e)},disable:we,enable:be,cancel:function(){ie.done(),ce.activateHandlers(null,null)},release:ie.release,destroy:function(){M.remove(),p.show(),me(e).removeData("Jcrop")},focus:fe.watchKeys,getBounds:function(){return[g*Y,O*X]},getWidgetSize:function(){return[g,O]},getScaleFactor:function(){return[Y,X]},ui:{holder:M,selection:F}};return me.browser.msie&&M.bind("selectstart",function(){return!1}),p.data("Jcrop",ye),ye},me.fn.Jcrop=function(t,a){function e(n){var o="object"===(void 0===t?"undefined":_typeof(t))?t:{},e=o.useImg||n.src,r=new Image;r.onload=function(){window.setTimeout(function e(){var t;r.width&&r.height?(t=me.Jcrop(n,o),"function"==typeof a&&a.call(t)):window.setTimeout(e,50)},50)},r.src=e}return this.each(function(){if(me(this).data("Jcrop")){if("api"===t)return me(this).data("Jcrop");me(this).data("Jcrop").setOptions(t)}else e(this)}),this},me.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,bgFade:!1,borderOpacity:.4,handleOpacity:.5,handleSize:9,handleOffset:5,aspectRatio:0,keySupport:!0,cornerHandles:!0,sideHandles:!0,drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onRelease:function(){}}}(jQuery);