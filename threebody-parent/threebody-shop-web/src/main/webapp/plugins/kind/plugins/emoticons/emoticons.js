KindEditor.plugin("emoticons",function(k){var b=this,e="emoticons",w=b.emoticonsPath||b.pluginsPath+"emoticons/images/",i=void 0===b.allowPreviewEmoticons||b.allowPreviewEmoticons,C=1;b.clickToolbar(e,function(){var l,u,p=5,d=9,f=0,v=p*d,s=Math.ceil(135/v),m=Math.floor(d/2),o=k('<div class="ke-plugin-emoticons"></div>'),g=[];function t(e,i){var n=document.createElement("table");i.append(n),l&&(k(n).mouseover(function(){l.show("block")}),k(n).mouseout(function(){l.hide()}),g.push(k(n))),n.className="ke-table",n.cellPadding=0,n.cellSpacing=0,n.border=0;for(var s=(e-1)*v+f,o=0;o<p;o++)for(var t=n.insertRow(o),a=0;a<d;a++){var c=k(t.insertCell(a));c.addClass("ke-cell"),function(e,i,n){l?e.mouseover(function(){m<i?(l.css("left",0),l.css("right","")):(l.css("left",""),l.css("right",0)),u.attr("src",w+n+".gif"),k(this).addClass("ke-on")}):e.mouseover(function(){k(this).addClass("ke-on")}),e.mouseout(function(){k(this).removeClass("ke-on")}),e.click(function(e){b.insertHtml('<img src="'+w+n+'.gif" border="0" alt="" />').hideMenu().focus(),e.stop()})}(c,a,s);var r=k('<span class="ke-img"></span>').css("background-position","-"+24*s+"px 0px").css("background-image","url("+w+"static.gif)");c.append(r),g.push(c),s++}return n}b.createMenu({name:e,beforeRemove:function(){r()}}).div.append(o),i&&(l=k('<div class="ke-preview"></div>').css("right",0),u=k('<img class="ke-preview-img" src="'+w+f+'.gif" />'),o.append(l),l.append(u));var a,c=t(C,o);function r(){k.each(g,function(){this.unbind()})}function h(e){a=k('<div class="ke-page"></div>'),o.append(a);for(var i,n=1;n<=s;n++)e!==n?(function(e,i){e.click(function(e){r(),c.parentNode.removeChild(c),a.remove(),c=t(i,o),h(i),C=i,e.stop()})}(i=k('<a href="javascript:;">['+n+"]</a>"),n),a.append(i),g.push(i)):a.append(k("@["+n+"]")),a.append(k("@&nbsp;"))}h(C)})});