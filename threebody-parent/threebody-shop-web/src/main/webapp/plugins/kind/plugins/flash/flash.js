KindEditor.plugin("flash",function(u){var r=this,s="flash",h=r.lang(s+"."),p=u.undef(r.allowFlashUpload,!0),c=u.undef(r.allowFileManager,!1),g=u.undef(r.formatUploadUrl,!0),f=u.undef(r.extraFileUploadParams,{}),m=u.undef(r.filePostName,"imgFile"),v=u.undef(r.uploadJson,r.basePath+"php/upload_json.php");r.plugin.flash={edit:function(){var t,e=['<div style="padding:20px;">','<div class="ke-dialog-row">','<label for="keUrl" style="width:60px;">'+h.url+"</label>",'<input class="ke-input-text" type="text" id="keUrl" name="url" value="" style="width:160px;" /> &nbsp;','<input type="button" class="ke-upload-button" value="'+h.upload+'" /> &nbsp;','<span class="ke-button-common ke-button-outer">','<input type="button" class="ke-button-common ke-button" name="viewServer" value="'+h.viewServer+'" />',"</span>","</div>",'<div class="ke-dialog-row">','<label for="keWidth" style="width:60px;">'+h.width+"</label>",'<input type="text" id="keWidth" class="ke-input-text ke-input-number" name="width" value="550" maxlength="4" /> ',"</div>",'<div class="ke-dialog-row">','<label for="keHeight" style="width:60px;">'+h.height+"</label>",'<input type="text" id="keHeight" class="ke-input-text ke-input-number" name="height" value="400" maxlength="4" /> ',"</div>","</div>"].join(""),a=r.createDialog({name:s,width:450,title:r.lang(s),body:e,yesBtn:{name:r.lang("yes"),click:function(){var e=u.trim(i.val()),t=o.val(),a=d.val();"http://"==e||u.invalidUrl(e)?i[0].focus():/^\d*$/.test(t)?/^\d*$/.test(a)?(a=u.mediaImg(r.themesPath+"common/blank.gif",{src:e,type:u.mediaType(".swf"),width:t,height:a,quality:"high"}),r.insertHtml(a).hideDialog().focus()):d[0].focus():o[0].focus()}}}),l=a.div,i=u('[name="url"]',l),n=u('[name="viewServer"]',l),o=u('[name="width"]',l),d=u('[name="height"]',l);i.val("http://"),p?(t=u.uploadbutton({button:u(".ke-upload-button",l)[0],fieldName:m,extraParams:f,url:u.addParam(v,"dir=flash"),afterUpload:function(e){var t;a.hideLoading(),0===e.error&&(t=e.url,g&&(t=u.formatUrl(t,"absolute")),i.val(t),r.afterUpload&&r.afterUpload.call(r,t,e,s))},afterError:function(e){a.hideLoading(),r.errorDialog(e)}})).fileBox.change(function(e){a.showLoading(r.lang("uploadLoading")),t.submit()}):u(".ke-upload-button",l).hide(),c?n.click(function(e){r.loadPlugin("filemanager",function(){r.plugin.filemanagerDialog({viewType:"LIST",dirName:"flash",clickFn:function(e){1<r.dialogs.length&&(u('[name="url"]',l).val(e),r.afterSelectFile&&r.afterSelectFile.call(r,e),r.hideDialog())}})})}):n.hide();e=r.plugin.getSelectedFlash();e&&(n=u.mediaAttrs(e.attr("data-ke-tag")),i.val(n.src),o.val(u.removeUnit(e.css("width"))||n.width||0),d.val(u.removeUnit(e.css("height"))||n.height||0)),i[0].focus(),i[0].select()},delete:function(){r.plugin.getSelectedFlash().remove()}},r.clickToolbar(s,r.plugin.flash.edit)});